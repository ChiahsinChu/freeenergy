\section{Orthogonal Space Random Walk\label{Sec:ES:OSRW}}
The orthogonal space random walk (OSRW) was developed by Yang.\cite{ZhengPNAS2008}
Phase space sampling is always hindered by free energy barriers. As shown above, several methods have been proposed to accelerate the transition between two states separated by a large free energy barrier, via alchemical process or enhanced conformational switching. In alchemical process, we define a coupling parameter $\lambda$. Similarly, in conformational switching we define a reaction coordinate $\mathbf{S}$. Essentially, these two methods are the same, because the coupling parameter $\lambda$ can be thought as a coordinate for extended dynamics. Without loss of generality, we can write the free energy difference with the order parameter $\xi=\xi_i$ and $\xi=\xi_f$ as
\begin{equation}
	\Delta G(\xi_i \rightarrow \xi_f)=\int_{\xi_i}^{\xi_f}\frac{\partial G}{\partial \xi}\bigg\rvert_{\xi^\prime} d\xi^\prime=\int_{\xi_i}^{\xi_f}\left<\frac{\partial U}{\partial \xi}-RT\frac{\partial \ln{|J|}}{d\xi}\right>_{\xi^\prime}d\xi^\prime,
\end{equation}
where $J$ is the Jacobian term corresponding to the coordinate transformation between the Cartesian coordinates and the reaction coordinates, and $\frac{\partial U}{\partial \xi}-RT\frac{\partial \ln{|J|}}{d\xi}$ can be regarded as the generalized force $\mathbf{F}_\xi$ on $\xi$. Because the transformation from $\xi=\xi_i$ to $\xi=\xi_f$ is slow. We can either constrain or restrain the system to a series of $\xi^\prime$. Unfortunately, albeit the acceleration in the reaction coordinate, the relaxation of the other degrees of freedom is usually hindered by some ``hidden barrier'' and is not able to catch up with the alternation of the reaction coordinate. This is called ``Hamiltonian lagging'' as identified by Kollman et al.\cite{PearlmanJCP1989} Therefore, acceleration of the space orthogonal to the reaction coordinate is equally important as the acceleration of the reaction coordinate.

Orthogonal space random walk is one of the approaches that can deal with this difficulty. In this method, a small two dimensional biasing potential $G(\xi,F_{\xi})$, instead of a one-dimensional one as in metadynamics, is added to the Hamiltonian of the system recursively, which has a functional form like
\begin{equation}
   h\exp{\left(-\frac{\lvert\xi-\xi(t_i)\rvert^2}{2{w_1}^2}\right)}\exp{\left(-\frac{\lvert \mathbf{F}_{\xi}-\mathbf{F}_{\xi}(t_i)\rvert^2}{2{w_2}^2}\right)}.
\end{equation}
The overall biasing potential
\begin{equation}
G(\xi,\mathbf{F}_\xi)=\sum\limits_{t_i}h\exp{\left(-\frac{\lvert\xi-\xi(t_i)\rvert^2}{2{w_1}^2}\right)}\exp{\left(-\frac{\lvert \mathbf{F}_{\xi}-\mathbf{F}_{\xi}(t_i)\rvert^2}{2{w_2}^2}\right)}.
\end{equation}
will eventually flatten the underlying free energy surface along the orthogonal space.
Application of this biasing potential to conformational free energy calculations is straightforward, while for alchemical free energy calculations it can be realized by $\lambda$-dynamics developed by Charlie Brooks.\cite{KongJCP1996} Similar to metadynamics, the free energy profile along the reaction coordinate $\left[\xi(t_i), \mathbf{F_\xi}\right]$ can be estimated as $-G\left(\xi,\mathbf{F_{\xi}}\right)+C$, where $C$ is an irrelevant constant. Correspondingly, the generalized force distribution at $\xi^\prime$ should be proportional to $\exp{\left[\beta G\left(\xi^\prime,\mathbf{F}_{\xi^\prime}\right)\right]}$, and the free-energy derivative can be obtained via
\begin{equation}
	\frac{\partial G}{\partial \xi}\bigg\rvert_{\xi^\prime}=\left<\mathbf{F}_\xi\right>_{\xi^\prime}=\frac{\sum\mathbf{F}_\xi\exp{\left[\beta G(\xi,\mathbf{F}_\xi)\right]}\delta(\xi-\xi^\prime)}{\sum\exp{\left[\beta G(\xi,\mathbf{F}_\xi)\right]}\delta(\xi-\xi^\prime)},
\end{equation}
which can be fed into the thermodynamic integration formula to obtain the free energy change from $\xi=\xi_i$ to any target state with the order parameter $\xi$ as the following
\begin{equation}
	\Delta G(\xi) = \int_{\xi_i}^{\xi}\frac{\partial G}{\partial \xi}\bigg\rvert_{\xi^\prime}d\xi^\prime.
\end{equation}