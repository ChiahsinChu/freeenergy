%%%%%%%%%%%%%%%%
% NEW CHAPTER! %
%%%%%%%%%%%%%%%%
\chapter{Introduction\label{chapter:introduction}}

\begin{chapquote}{Albert Einstein, %\textit{\url{https://en.wikiquote.org/wiki/Albert_Einstein}}
	}
``Everything should be made as simple as possible but not simpler.''
\end{chapquote}

Computer simulations of biological system have made much progress in the past decades. 

We are still facing many difficulties in three aspects, i.e. Hamiltonians, sampling efficiency and postprocessing methods.\cite{NielsJCTC2014}

In this booklet, we will not cover the whole spectrum of methods for enhanced samplings and free energy calculations, but only summarize some basic ideas. 
More complicated implementations of these methods, for instance 2-dimensional replica exchange molecular dynamics simulations, will not be discussed.

Recently, there is one special issue focusing on the methodologies of free energy calculations on Journal of Chemical Theory and Computation (Free Energy Calculations: Three Decades of Adventure in Chemistry and Biophysics, Journal of Chemical Theory and Computation, Volume 10, Issue 7, 2014, \url{http://pubs.acs.org/toc/jctcce/10/7}). 

There are also two books on this topic you might be interested in:
\begin{itemize}
\item Free Energy Calculations: Theory and Applications in Chemistry and Biology, Editors: Christophe Chipot, Andrew Pohorille, ISBN 978-3-540-38448-9, Springer-Verlag Berlin Heidelberg, 2007
\item Free Energy Computations: A Mathematical Perspective, Author: Tony Lelievre, Gabriel Stoltz, Mathias Rousset, ISBN-13: 978-1848162471, Imperial College Press, 2010
\end{itemize}

Before we move into the major content of this booklet, we would like to review some fundamentals that underlie the methods introduced in the following chapters. The first one is the canonical partition function $Q$ for Hamiltonian $H(\mathbf{x},\mathbf{p}_{x})$, which is defined as
\begin{align}
  Q(N,V,T)=&\frac{1}{{h}^{3N}N!} \iint \exp[-\beta H(\mathbf{x},\mathbf{p}_{x})] d\mathbf{x}d\mathbf{p}_\mathbf{x}\notag\\
         =&\frac{1}{\Lambda^{3N}N!}Z(N,V,T),
\end{align}
where $\mathbf{x}$ and $\mathbf{p}_{x}$ are the coordinates and the conjugate momenta, respectively,
\begin{equation}
	Z(N,V,T)=\int \exp{\left(-\beta U(\mathbf{x})\right)}d\mathbf{x}
\end{equation}
is the configurational integral, $\Lambda$ is the temperature-dependent de Broglie wavelength, and $U(\mathbf{x})$ is the potential energy.

The partition function $Q$ can also be defined in energy space as
\begin{equation}
	Q(N,V,T)=\int \exp{\left(-\beta E\right)}\varOmega_{tot}(N,V,E)dE,
\end{equation}
where
\begin{equation}
	\varOmega_{tot}(N,V,E)=\frac{1}{{h}^{3N}N!}\iint_{V^N} \delta(H(\mathbf{x},\mathbf{p}_{x})-E)d\mathbf{x}d\mathbf{p}_\mathbf{x}
\end{equation}
is the complete density of states. Correspondingly, we can also define the configurational density of state as
\begin{equation}
	\varOmega_{con}\propto\frac{1}{N!}\int_{V^N} \delta(U(\mathbf{x})-E)d\mathbf{x}.
\end{equation}

The Helmholtz free energy is defined in terms of the canonical partition function as
\begin{equation}
A=-\beta^{-1}\ln{Q(N,V,T)},
\end{equation}
which connects thermodynamics and statistical mechanics. If we can estimate the value of $Q$, we can calculate $A$. However, evaluating $Q$ is very difficult in most cases. Fortunately, we are only interested in the free energy differences, $\Delta A$, between two systems or two states of a systems denoted by 0 and 1, respectively
\begin{equation}
\Delta A=-\beta^{-1}\ln{Q_1/Q_0}.
\label{Eq:Intro:dA}
\end{equation}
In most situations we are dealing with, the masses of particles in systems 0 and 1 are the same, Eq.~\ref{Eq:Intro:dA} can be rewritten in terms of the configurational integrals $Z_0$ and $Z_1$
\begin{equation}
\Delta A=-\beta^{-1}\ln{Z_1/Z_0}.
\end{equation}

In the following chapters, the systems 0 and 1 may differ in several ways. They may have different Hamiltonians, $H_0$ and $H_1$. Or they may be characterized by different values of a macroscopic parameter, such as temperature. Finally, they may correspond to different regions in the phase space accessible to the system
\begin{align}
Q_0=&\frac{1}{N!h^{3N}}\int_{\Gamma_0}\exp{\left[-\beta H(\mathbf{x},\mathbf{p}_x)\right]}d\mathbf{x}d\mathbf{p}_x\\
Q_1=&\frac{1}{N!h^{3N}}\int_{\Gamma_1}\exp{\left[-\beta H(\mathbf{x},\mathbf{p}_x)\right]}d\mathbf{x}d\mathbf{p}_x
\end{align}
where $\Gamma_0$ and $\Gamma_1$ may refer to different conformations of a flexible molecules, or the bound and unbound structures of a protein-ligand complex.

Besides free energy, sometimes we are also interested in the free energy profile along one or several degrees of freedom
\begin{equation}
	A(\xi)=-\beta^{-1}\ln{Z(\xi)}=-\beta^{-1}\ln\int \exp{\left(-\beta U\right)}\delta(\xi-\xi(\mathbf{x}))d\mathbf{x}.
\end{equation}
Its gradient over $\xi$ is
\begin{align}
\frac{\partial A(\xi)}{\partial \xi}=&-\beta^{-1}\frac{\int \frac{\partial}{\partial \xi}\left(e^{-\beta U}|J|\right)dq_1\cdots dq_{N-1}}{\int e^{-\beta U}\delta(\xi-\xi(\mathbf{x}))d\mathbf{x}}\notag\\
                                    =&\frac{\int \exp{\left(-\beta U\right)}\left[\frac{\partial U}{\partial \xi}-\beta^{-1}\frac{1}{|J|}\frac{\partial |J|}{\partial \xi}\right]|J|dq_1\cdots dq_{N-1}}{\int e^{-\beta U}\delta(\xi-\xi(\mathbf{x}))d\mathbf{x}}\notag\\
                                    =&\frac{\int \exp{\left(-\beta U\right)}\left[\frac{\partial U}{\partial \xi}-\beta^{-1}\frac{\partial \ln|J|}{\partial \xi}\right]|J|dq_1\cdots dq_{N-1}}{\int e^{-\beta U}\delta(\xi-\xi(\mathbf{x}))d\mathbf{x}}\notag\\
                                    =&\frac{\int \exp{\left(-\beta U\right)}\left[\frac{\partial U}{\partial \xi}-\beta^{-1}\frac{\partial \ln|J|}{\partial \xi}\right]\delta(\xi-\xi(\mathbf{x}))d\mathbf{x}}{\int e^{-\beta U}\delta(\xi-\xi(\mathbf{x}))d\mathbf{x}}\notag\\
                                    =&\left<\frac{\partial U}{\partial \xi}-\beta^{-1}\frac{\partial \ln |J|}{\partial \xi}\right>_\xi.
\end{align}